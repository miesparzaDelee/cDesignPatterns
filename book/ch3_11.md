## Intrusive Callback Pattern

### Overview

High-performance event system using embedded callback nodes. Listener objects embed the callback structure. The event source holds an intrusive linked list of these nodes. Uses `CONTAINER_OF` to recover the listener object from the embedded callback field.

### Implementation

#### Listener Structure

```c
typedef struct {
    shape_event_listener_t listener;  // embedded node
    uint32_t count;
} MyListener;
```

#### Event Source

```c
void shapeEventSource_process(shape_t* shape) {
    // Check boundary/threshold/collision
    if (event_occurred) {
        // For each listener node
        for (each listener) {
            listener->onEvent(listener, shape);
        }
    }
}
```

#### Listener Retrieval

```c
void onEvent(shape_event_listener_t* listener, shape_t* shape) {
    MyListener* self = CONTAINER_OF(listener, MyListener, listener);
    // Use self->count, etc.
}
```

### Important Notes

- **Zero allocation**, extremely efficient
- Ideal for:
  - Real-time loops
  - Kernel-like systems
  - Performance-critical code
- Embedded nodes allow fast registration and minimal memory overhead
- **Most powerful but most advanced** callback pattern
